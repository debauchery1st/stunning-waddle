#:import Clipboard kivy.core.clipboard.Clipboard
#:set bkg_color (.16862745098039217, .16862745098039217, .16862745098039217, 1)
#:set foreground_clr (0.6784313725490196, 0.6784313725490196, 0.6784313725490196, 1)

<ChatInput>

<ChatMessage>:
    markup: 1
    background_color: bkg_color
    foreground_color: foreground_clr
    text_size: (self.width, None)
    halign: 'left'
    valign: 'top'
    size_hint: 1, None
    height: self.texture_size[1]
    on_release: Clipboard.copy(self.plaintext)


ScreenManager:
    Screen:
        name: 'login'
        BoxLayout:
            orientation: 'vertical'
            Label:
                text: 'Server:'
            TextInput:
                id: server
                text: app.chat_ip

            Label:
                text: 'Nickname:'
            TextInput:
                id: nickname
                text: app.nick
            Button:
                text: 'Connect'
                on_press: app.connect()
    Screen:
        name: 'lobby'
        BoxLayout:
            orientation: 'vertical'
            id: chat_window
            Button:
                text: 'Disconnect'
                size_hint_y: .05
                on_press: app.disconnect()
            BoxLayout:
                id: local_input
                orientation: 'horizontal'
                size_hint_y: .1
                ChatInput:
                    id: message
                    multiline: False
                    size_hint_y: .5
                    text: "type message here"
                Button:
                    text: 'send'
                    on_press: app.send_msg()
                    focus_next: message
                    size_hint: (None, .5)
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: .6
                ScrollView:
                    id: chat_view
                    GridLayout:
                        id: chat_logs
                        cols: 1
                        size_hint_y: None
                        height: sum(x.height * 1.25 for x in self.children)
                Label:
                    id: active_users
                    markup: 1
                    halign: 'left'
                    valign: 'top'
                    size_hint: None, None
                    text: app.chat_users
